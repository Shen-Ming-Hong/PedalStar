# 光光星 PedalStar 🚴‍♂️✨

一個互動式兒童遊樂設施，透過踩踏腳踏車來累積能量並點亮 LED 燈光效果。

## 專案簡介

光光星是一個創新的兒童遊樂設施，將兒童腳踏車架高懸空，讓小朋友透過踩踏腳踏板來產生「能量」。在固定時間內，輪子旋轉的圈數越多，累積的能量就越多，相應地會點亮更多的 LED 燈，為小朋友帶來即時的視覺回饋與成就感。

## 功能特色

-   **能量累積系統**：透過霍爾感測器偵測輪子旋轉圈數
-   **即時燈光回饋**：根據累積能量動態點亮雙色 LED 燈（紅、綠），模擬星星顏色從紅色到黃色到綠色的漸變
-   **互動性強**：小朋友可以直接看到自己踩踏的成果
-   **安全設計**：腳踏車架空設計，安全無虞

## 硬體需求

### 主要元件

-   **Arduino Uno** - 主控制板
-   **霍爾感測器（Hall Sensor）模組** - 偵測輪子旋轉（型號：A3144）
-   **磁鐵** - 配合霍爾感測器使用
-   **雙色 LED 燈（RG LED）× 5** - 能量顯示與星星顏色效果（紅、綠雙色，共陰極）
-   **兒童腳踏車** - 遊樂設施主體

### 連接方式

```
Arduino Uno（優化接線 - 相鄰腳位配對）
├─ 霍爾感測器 → D2（數位腳位，支援中斷）
├─ LED 接線（每顆燈的 G-R 腳位盡量相鄰）：
│ ├─ LED1: G→D3(PWM), R→D4 ★ 相鄰
│ ├─ LED2: G→D5(PWM), R→D7
│ ├─ LED3: G→D6(PWM), R→D8
│ ├─ LED4: G→D9(PWM), R→D12
│ └─ LED5: G→D10(PWM), R→D11 ★ 相鄰
└─ 電源供應（5V）

```

**接線優化特色**：

-   LED1 和 LED5 的 R-G 腳位完全相鄰（D3-D4、D10-D11）
-   其他 LED 的腳位也盡量接近，減少跳線複雜度
-   綠色通道全部使用 PWM 腳位，支援漸變效果
-   避免使用 D13（板載 LED，會影響除錯）
-   紅+綠混合可產生星星的黃色光芒

## 專案結構

```

PedalStar/
├── platformio.ini # PlatformIO 專案配置檔
├── README.md # 專案說明文件（本檔案）
├── src/
│ └── main.cpp # 主程式碼
├── include/ # 標頭檔目錄
├── lib/ # 自訂函式庫目錄
└── test/ # 測試程式目錄

```

## 工作原理

1. **感測階段**：磁鐵固定在腳踏車輪子上，每旋轉一圈會經過霍爾感測器一次
2. **計數階段**：Arduino 透過中斷機制即時計算旋轉圈數
3. **能量累積**：根據旋轉圈數累積能量值（0-100%）
4. **燈光回饋**：能量越多，點亮的 LED 燈數量就越多，顏色也會從紅色 → 橙色 → 黃色 → 黃綠色 → 綠色漸變，模擬星星的發光效果
5. **能量衰減**：停止踩踏 3 秒後，能量會逐漸衰減（衰減速度可調整）

## 開發環境

本專案使用 **PlatformIO** 開發，支援：

-   平台：Atmel AVR
-   開發板：Arduino Uno
-   框架：Arduino

## 參數調整

遊戲難度可透過修改 `src/main.cpp` 中的參數來調整：

### 關鍵參數說明

| 參數            | 說明                             | 調整建議               |
| --------------- | -------------------------------- | ---------------------- |
| `MAX_ROTATIONS` | 達到 100% 能量所需的每秒旋轉圈數 | 增加=更難，減少=更容易 |
| `DECAY_RATE`    | 能量衰減速度（%/秒）             | 增加=能量消失更快      |
| `IDLE_TIMEOUT`  | 開始衰減前的等待時間（毫秒）     | 增加=能量保持更久      |
| `TIME_WINDOW`   | 能量計算週期（毫秒）             | 建議維持 1000          |

### 難度建議值

根據使用者年齡和體力，可以調整以下參數組合：

**簡單模式**（適合年幼兒童，4-6 歲）：

```cpp
#define MAX_ROTATIONS 15    // 更容易達成
#define DECAY_RATE 5        // 能量保持較久
```

**適中模式**（適合一般兒童，7-9 歲）：

```cpp
#define MAX_ROTATIONS 20-25 // 需要一定努力
#define DECAY_RATE 6-8      // 適度衰減
```

**困難模式**（適合年長兒童，10 歲以上）：

```cpp
#define MAX_ROTATIONS 35-50 // 需要非常努力
#define DECAY_RATE 10-12    // 能量快速消失
```

💡 **調整建議**：先從較低的 `MAX_ROTATIONS` 值開始測試，觀察兒童實際踩踏速度後再逐步調整。

### 能量與燈光對應關係

能量百分比決定點亮的 LED 數量和顏色（以 `MAX_ROTATIONS` 為基準）：

| 能量範圍 | LED 數量 | 顏色      | 所需圈數比例 |
| -------- | -------- | --------- | ------------ |
| 0-20%    | 1 顆     | 🔴 紅色   | 20% × MAX    |
| 20-40%   | 2 顆     | 🟠 橙色   | 40% × MAX    |
| 40-60%   | 3 顆     | 🟡 黃色   | 60% × MAX    |
| 60-80%   | 4 顆     | 🟢 黃綠色 | 80% × MAX    |
| 80-100%  | 5 顆     | 💚 綠色   | 100% × MAX   |

**範例計算**（假設 `MAX_ROTATIONS = 20`）：

-   點亮 1 顆燈：1 秒內轉 4 圈（20% × 20）
-   點亮 3 顆燈：1 秒內轉 12 圈（60% × 20）
-   點亮 5 顆燈：1 秒內轉 20 圈（100% × 20）

## 使用方式

### 1. 安裝開發環境

確保已安裝 [PlatformIO](https://platformio.org/) 或 [VS Code](https://code.visualstudio.com/) + PlatformIO 擴充套件。

### 2. 編譯專案

```bash
pio run
```

### 3. 上傳到 Arduino

```bash
pio run --target upload
```

### 4. 監控序列埠（除錯用）

```bash
pio device monitor
```

## 未來擴充

-   [ ] 新增音效回饋
-   [ ] 記錄最高分數
-   [ ] 多人競賽模式
-   [ ] 更多燈光效果模式

## 授權

本專案為教育與創作用途。

## 貢獻

歡迎提出建議與改進！

---

**打造屬於孩子們的能量世界！** 🌟
